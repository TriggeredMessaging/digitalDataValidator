/*global suite, test, require, setup */
var should = require('should');

suite('The validator', function () {
    test('should be importable', function (done) {
        var validator = require("../index.js");
        should.exist(validator);
        done();
    });

});

suite('The validator', function () {
    var validator;
    setup(function (done) {
        validator = require("../index.js");
        done();
    });

    test('should have a run function', function (done) {
        validator.run.should.be.type("function");
        done();
    });

    test('should validate an empty object correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {};
        expected = {
            types: {
                _typeExpected: 'object',
                _typeFound: 'object',
                _typeCheck: 'passed'
            },
            hasEmptyObjects: true,
            emptyObjects: { _isEmpty: true },
            missingObjects: {
                version: { _isMissing: true, _doc: '' },
                page: { _isMissing: true, _doc: '' }
            },
            isProductsMissingInCategoryPage: false,
            isProductsMissingInCart: false
        };

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate test.example.com/superfoods.html correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://test.example.com/superfoods.html", "breadcrumbs": ["Superfoods"], "language": "en_GB", "pageName": "Superfoods"}, "category": {"primaryCategory": "Superfoods", "pageType": "category"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "product": [
            {"productInfo": {"productID": "1384", "productName": "Goji Berries", "description": "Lycium from which goji berries are harvested, is a deciduous, woody, perennial, shrub that grows to a height of 1-3 metres. The leaves are generally lanceolate (spear-shaped) sometimes ovate and are approximately 7cm in length. The 5 petaled flowers are light purple in colour fading to pale lilac or white, when the flowers fade the bright orangey-red berries appear.", "productURL": "http://test.example.com/superfoods/goji-berries-1384.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/0/9/09lyc-goji_berries.jpg"}, "category": {"primaryCategory": "Herbs", "subCategory1": "Whole Seeds", "subCategory2": "Superfoods"}, "price": {"basePrice": 2.62, "currency": "GBP", "priceWithTax": 0, "taxRate": 0}},
            {"productInfo": {"productID": "4471", "productName": "Barley Grass Juice powder", "description": "Barley Grass Juice Powder is extracted from the young leaves of barley by dehydrating the green juice of the leaves to a fine powder at room temperature, using a patented spray-drying process.\r\n\r\nThis mild and delicate flavored powder mixes easily with juices, smoothies, and shakes.", "productURL": "http://test.example.com/superfoods/barleygrass-juice-powder.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/b/a/barley_grass_1.jpg"}, "category": {"primaryCategory": "Botanical Herbs", "subCategory1": "Culinary Herbs and Spices", "subCategory2": "Herb Powders"}, "price": {"basePrice": 11.96, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}},
            {"productInfo": {"productID": "3842", "productName": "Catuaba Bark Powder", "description": "Catuaba is a small is small tree native to the tropical rainforests of Brazil that grows to a height of 2-4 metres. The leaves are simple, entire and alternate, glossy and glaucous green in colour on the upper surface, paler green below and are ovately lanceolate in shape. The 5-petaled flowers grow in clusters and are white to orangey-yellow in colour.", "productURL": "http://test.example.com/superfoods/catuaba-bark-powder-3842.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumb…/75x75/9df78eab33525d08d6e5fb8d27136e95/2/4/24catu-catuaba_bark_powder.jpg"}, "category": {"primaryCategory": "Herb Powders", "subCategory1": "Superfoods", "subCategory2": "Herb Powders"}, "price": {"basePrice": 3.2, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}},
            {"productInfo": {"productID": "1742", "productName": "Spirulina Powder", "description": "Our high quality spirulina powder is made from a combination of 2 blue-green algae&rsquo;s Arthrospira platensis and Arthrospira maxima, both of which are simple, free-floating, filamentous, cyanobacteria.", "productURL": "http://test.example.com/superfoods/spirulina-powder-1742.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/0/9/09spir-spirulina_powder.jpg"}, "category": {"primaryCategory": "Herb Powders", "subCategory1": "Superfoods", "subCategory2": "Herb Powders"}, "price": {"basePrice": 3.03, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}},
            {"productInfo": {"productID": "991", "productName": "Chlorella Powder", "description": "Chlorella is a member of the seaweed family of plants that is a blue-green, spherical, single cell alga, which grows in fresh water and is believed to be one of the world’s most complete foods. It provides protein, carbohydrate, amino acids, fibre, peptides, vitamins, minerals and enzymes. Each single cell measures between 2-10 micrometres in diameter, the plant rapidly multiplies where sun is prevalent using the chemical process known as photosynthesis.", "productURL": "http://test.example.com/superfoods/chlorella-powder-991.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/0/9/09chl-chlorella_powder.jpg"}, "category": {"primaryCategory": "Herb Powders", "subCategory1": "Superfoods", "subCategory2": "Herb Powders"}, "price": {"basePrice": 9.1, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}},
            {"productInfo": {"productID": "4094", "productName": "Maca Root Powder", "description": "Maca root is a tuberose root that comes from an annual herbaceous perennial native to Peru and Bolivia that reaches a height of 10-20cm. The basal leaves form a rosette and are bi-pinnate and feathery and grow to approximately 20-25cm in length along a long, fleshy stem, they are mid green in colour. The small 4-petaled flowers form in some of the centre of the basal leaf axils, they are off-white in colour. The roots resemble a turnip in size and shape and can be black, red or yellow in colour.", "productURL": "http://test.example.com/superfoods/maca-root-powder-4094.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/2/4/24mac-macca_root_powder.jpg"}, "category": {"primaryCategory": "Herb Powders", "subCategory1": "Superfoods", "subCategory2": "Spice Finder"}, "price": {"basePrice": 3.07, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}},
            {"productInfo": {"productID": "2767", "productName": "Bee Pollen", "description": "Our Bee Pollen is produced in the anthers of flowering plants; this fine powder is bound together by the bees with fructose, glucose and their saliva and is used as a source of protein. Bee pollen has often been described as a ‘superfood’ and one of ‘natures perfect foods’, given that bee pollen is believed to offer the most comprehensive range of trace elements, minerals including copper, potassium, iron, magnesium and zinc, amino acids, and Vitamins including B-complex A, C, D and E. Bee pollen is comprised of approximately 30% protein, 55% carbohydrate, 1% to 2% fat, and 3% minerals, vitamins and trace elements, it’s to be noted that the composition of bee pollen is not static as it depends on the country of origin, time of the year and the plant material the pollen is collected from.", "productURL": "http://test.example.com/superfoods/bee-pollen-2767.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/1/5/15be-bee_pollen.jpg"}, "category": {"primaryCategory": "Granules", "subCategory1": "Superfoods"}, "price": {"basePrice": 3.53, "currency": "GBP", "priceWithTax": 0, "taxRate": 0}},
            {"productInfo": {"productID": "4476", "productName": "Wheat Grass Juice Powder", "description": "Wheat Grass Juice Powder is extracted from the young leaves of wheat by dehydrating the green juice of the leaves to a fine powder at room temperature, using a patented spray-drying process. \r\n\r\nThis mild and delicate flavored powder mixes easily with juices, smoothies, and shakes.\r\n", "productURL": "http://test.example.com/superfoods/wheat-grass-juice-powder.html", "productImage": "http://test.example.com/media/catalog/product/cache/1/image…9df78eab33525d08d6e5fb8d27136e95/placeholder/websites/1/ji-coming-soon.jpg", "productThumbnail": "http://test.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/w/h/wheat_grass.jpg"}, "category": {"primaryCategory": "Botanical Herbs", "subCategory1": "Culinary Herbs and Spices", "subCategory2": "Herb Powders"}, "price": {"basePrice": 8.91, "currency": "GBP", "priceWithTax": 0, "taxRate": 0.2}}
        ]};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "breadcrumbs": {"0": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "product": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "3": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "4": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "5": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "6": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "7": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory2": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com homepage correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/", "language": "en_GB", "pageName": "Home page"}, "category": {"pageType": "home"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/coalesce-functioning-on-impatience-t-shirt.html correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt.html", "referringURL": "ecom.example.com", "breadcrumbs": ["Coalesce: Functioning On Impatience T-Shirt"], "language": "en_GB", "pageName": "Coalesce: Functioning On Impatience T-Shirt"}, "category": {"pageType": "product"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "product": [
            {"productInfo": {"productID": "119", "productName": "Coalesce: Functioning On Impatience T-Shirt", "description": "\r\n\r\n\r\n6.1 oz. 100% preshrunk heavyweight cotton\r\nShoulder-to-shoulder taping\r\nDouble-needle sleeves and bottom hem\r\n", "productURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78ea…25d08d6e5fb8d27136e95/c/o/coalesce-functioning-on-impatience-t-shirt-1.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…25d08d6e5fb8d27136e95/c/o/coalesce-functioning-on-impatience-t-shirt-1.jpg", "size": "0.5000"}, "category": {"primaryCategory": "Shirts"}, "price": {"basePrice": 15, "currency": "GBP", "priceWithTax": 13, "taxRate": 0}, "linkedProduct": [
                {"productInfo": {"productID": "35", "productName": "Coalesce: Functioning On Impatience T-Shirt", "description": "# 6.1 oz. 100% preshrunk heavyweight cotton \r\n# Shoulder-to-shoulder taping\r\n# Double-needle sleeves and bottom hem", "productURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt-small.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…b33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/thumbnail.jpg", "size": "0.5000"}, "category": {"primaryCategory": "Shirts"}, "price": {"basePrice": 15, "currency": "GBP", "priceWithTax": 15, "taxRate": 0}},
                {"productInfo": {"productID": "117", "productName": "Coalesce: Functioning On Impatience T-Shirt", "description": "# 6.1 oz. 100% preshrunk heavyweight cotton \r\n# Shoulder-to-shoulder taping\r\n# Double-needle sleeves and bottom hem", "productURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt-medium.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…b33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/thumbnail.jpg", "size": "0.5000"}, "category": {"primaryCategory": "Shirts"}, "price": {"basePrice": 15, "currency": "GBP", "priceWithTax": 15, "taxRate": 0}},
                {"productInfo": {"productID": "118", "productName": "Coalesce: Functioning On Impatience T-Shirt", "description": "# 6.1 oz. 100% preshrunk heavyweight cotton \r\n# Shoulder-to-shoulder taping\r\n# Double-needle sleeves and bottom hem", "productURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt-large.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…b33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/thumbnail.jpg", "size": "0.5000"}, "category": {"primaryCategory": "Shirts"}, "price": {"basePrice": 15, "currency": "GBP", "priceWithTax": 15, "taxRate": 0}}
            ]}
        ]};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "breadcrumbs": {"0": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "product": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "linkedProduct": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/electronics/computers.html correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/electronics/computers.html", "referringURL": "http://ecom.example.com/coalesce-functioning-on-impatience-t-shirt.html", "breadcrumbs": ["Electronics", "Computers"], "language": "en_GB", "pageName": "Computers - Electronics"}, "category": {"primaryCategory": "Computers", "pageType": "category"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "product": [
            {"productInfo": {"productID": "163", "productName": "Computer", "description": "Make a computer", "productURL": "http://ecom.example.com/electronics/computers/computer.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/c/o/computer.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "Build Your Own"}, "price": {"basePrice": 398.98, "currency": "GBP", "priceWithTax": 0, "taxRate": 0}},
            {"productInfo": {"productID": "143", "productName": "Crucial 512MB PC4200 DDR2 533MHz Memory", "description": "Crucial 512MB PC4200 DDR2 533MHz Memory\r\nCrucial Technologies is part of Micron, the largest DRAM manufacturer in the U.S. and one of the largest in the world. Because they actually manufacture memory, they have unparalleled expertise in the upgrade industry. Crucial is the only consumer memory upgrade supplier that is part of a major DRAM manufacturer.\r\n\r\nEvery single Crucial memory module is tested before it goes out their doors. Crucial chips are individually tested under varying temperatures, voltages, and operational conditions for performance and functionality. ", "productURL": "http://ecom.example.com/electronics/computers/crucial-512mb-pc4200-ddr2-533mhz-memory.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…ab33525d08d6e5fb8d27136e95/c/r/crucial-512mb-pc4200-ddr2-533mhz-memory.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "RAM / Memory"}, "price": {"basePrice": 99.99, "currency": "GBP", "priceWithTax": 99.99, "taxRate": 0}},
            {"productInfo": {"productID": "141", "productName": "Crucial 1GB PC4200 DDR2 533MHz Memory", "description": "Crucial 1024MB PC4200 DDR2 533MHz Memory\r\nCrucial Technologies is part of Micron, the largest DRAM manufacturer in the U.S. and one of the largest in the world. Because they actually manufacture memory, they have unparalleled expertise in the upgrade industry. Crucial is the only consumer memory upgrade supplier that is part of a major DRAM manufacturer.\r\n\r\nEvery single Crucial memory module is tested before it goes out their doors. Crucial chips are individually tested under varying temperatures, voltages, and operational conditions for performance and functionality. ", "productURL": "http://ecom.example.com/electronics/computers/crucial-1gb-pc4200-ddr2-533mhz-memory.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…8eab33525d08d6e5fb8d27136e95/c/r/crucial-1gb-pc4200-ddr2-533mhz-memory.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "RAM / Memory"}, "price": {"basePrice": 150.99, "currency": "GBP", "priceWithTax": 150.99, "taxRate": 0}},
            {"productInfo": {"productID": "140", "productName": "Crucial 2GB PC4200 DDR2 533MHz Memory", "description": "Crucial 2GB PC4200 DDR2 533MHz Memory\r\nCrucial Technologies is part of Micron, the largest DRAM manufacturer in the U.S. and one of the largest in the world. Because they actually manufacture memory, they have unparalleled expertise in the upgrade industry. Crucial is the only consumer memory upgrade supplier that is part of a major DRAM manufacturer.\r\n\r\nEvery single Crucial memory module is tested before it goes out their doors. Crucial chips are individually tested under varying temperatures, voltages, and operational conditions for performance and functionality. ", "productURL": "http://ecom.example.com/electronics/computers/crucial-2gb-pc4200-ddr2-533mhz-memory.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…8eab33525d08d6e5fb8d27136e95/c/r/crucial-2gb-pc4200-ddr2-533mhz-memory.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "RAM / Memory"}, "price": {"basePrice": 199.99, "currency": "GBP", "priceWithTax": 199.99, "taxRate": 0}},
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/electronics/computers/acer-ferrari-3200-notebook-computer-pc.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0}},
            {"productInfo": {"productID": "25", "productName": "Apple MacBook Pro MA464LL/A 15.4\" Notebook PC", "description": "You've seen improvements in notebook performance before - but never on this scale. The Intel Core Duo powering MacBook Pro is actually two processors built into a single chip.", "productURL": "http://ecom.example.com/electronics/computers/apple-macbook-pro-ma464ll-…ebook-pc-2-0-ghz-intel-core-duo-1-gb-ram-100-gb-hard-drive-superdrive.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…25d08d6e5fb8d27136e95/a/p/apple-macbook-pro-ma464ll-a-15-4-notebook-pc.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 2299.99, "currency": "GBP", "priceWithTax": 2299.99, "taxRate": 0}},
            {"productInfo": {"productID": "28", "productName": "Toshiba M285-E 14\"", "description": "Get the competitive edge with the Gateway M285-E. This widescreen Convertible Notebook functions as both a conventional notebook and a tablet.", "productURL": "http://ecom.example.com/electronics/computers/toshiba-satellite-a135-s45…r-t2080-1-gb-ram-120-gb-hard-drive-supermulti-dvd-drive-vista-premium.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/t/o/toshiba-m285-e-14.jpg"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1599.99, "currency": "GBP", "priceWithTax": 1599.99, "taxRate": 0}},
            {"productInfo": {"productID": "164", "productName": "Gaming Computer", "description": "Make a computer", "productURL": "http://ecom.example.com/gaming-computer.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/g/a/gaming-computer.jpg"}, "category": {"primaryCategory": "Build Your Own"}, "price": {"basePrice": 4999.95, "currency": "GBP", "priceWithTax": 4999.95, "taxRate": 0}},
            {"productInfo": {"productID": "165", "productName": "My Computer", "description": "test description", "productURL": "http://ecom.example.com/my-computer.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/m/y/my-computer.jpg"}, "category": {"primaryCategory": "Build Your Own"}, "price": {"basePrice": 599.2275, "currency": "GBP", "priceWithTax": 0, "taxRate": 0}}
        ]};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "breadcrumbs": {"0": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "product": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "3": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "4": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "5": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "6": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "7": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "8": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/checkout/cart/ with a cart item correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/checkout/cart/", "referringURL": "http://ecom.example.com/electronics/computers/acer-ferrari-3200-notebook-computer-pc.html", "language": "en_GB", "pageName": "Shopping Cart"}, "category": {"pageType": "basket"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "cart": {"cartID": "225", "price": {"basePrice": 1799.99, "currency": "GBP", "taxRate": 0, "priceWithTax": 1799.99, "cartTotal": 1799.99}, "items": [
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/acer-ferrari-3200-notebook-computer-pc.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "size": "11.4000"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0, "cartTotal": 1799.99}, "quantity": 1}
        ]}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "items": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/furniture.html with a cart item correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/furniture.html", "referringURL": "http://ecom.example.com/furniture.html", "breadcrumbs": ["Furniture"], "language": "en_GB", "pageName": "Furniture"}, "category": {"primaryCategory": "Furniture", "pageType": "category"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "cart": {"cartID": "225", "price": {"basePrice": 1799.99, "voucherDiscount": 0, "currency": "GBP", "taxRate": 0, "priceWithTax": 1799.99, "cartTotal": 1799.99}, "items": [
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/catalog/product/view/id/26/s/acer-ferrari-3200-notebook-computer-pc/category/10/", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "size": "11.4000"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0, "voucherDiscount": 0, "cartTotal": 1799.99}, "quantity": 1}
        ]}, "product": [
            {"productInfo": {"productID": "51", "productName": "Ottoman", "description": "With durable solid wood framing, generous padding and plush stain-resistant microfiber upholstery.", "productURL": "http://ecom.example.com/ottoman.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/o/t/ottoman.jpg"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 299.99, "currency": "GBP", "priceWithTax": 299.99, "taxRate": 0}},
            {"productInfo": {"productID": "52", "productName": "Chair", "description": "Combining a hint of nostalgia with the up-to-date sensibility and function of modern chairs. It is in soft, velvety microfiber.", "productURL": "http://ecom.example.com/chair.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/c/h/chair.jpg"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 129.99, "currency": "GBP", "priceWithTax": 129.99, "taxRate": 0}},
            {"productInfo": {"productID": "53", "productName": "Couch", "description": "For a sleek, simple and stylish piece, look no further than the Magento sofa - or sofabed!", "productURL": "http://ecom.example.com/couch.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/c/o/couch.jpg"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 599.99, "currency": "GBP", "priceWithTax": 599.99, "taxRate": 0}},
            {"productInfo": {"productID": "54", "productName": "Magento Red Furniture Set", "description": "Love red?  You'll love these pieces of handmade modern furniture!", "productURL": "http://ecom.example.com/magento-red-furniture-set.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/m/a/magento-red-furniture-set.jpg"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 699.99, "currency": "GBP", "priceWithTax": 699.99, "taxRate": 0}},
            {"productInfo": {"productID": "41", "productName": "Akio Dresser", "description": "Our Akio dresser has a solid hardwood frame.  ", "productURL": "http://ecom.example.com/akio-dresser.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/a/k/akio-dresser.jpg"}, "category": {"primaryCategory": "Bedroom"}, "price": {"basePrice": 399.99, "currency": "GBP", "priceWithTax": 399.99, "taxRate": 0}},
            {"productInfo": {"productID": "42", "productName": "Barcelona Bamboo Platform Bed", "description": "Our Barcelona platform bed captures the spirit and drama of late 20th century design with a variety of subtle details.", "productURL": "http://ecom.example.com/barcelona-bamboo-platform-bed.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/images/catalog/product/placeholder/image.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/b/a/barcelona-bamboo-platform-bed.jpg"}, "category": {"primaryCategory": "Bedroom"}, "price": {"basePrice": 2299, "currency": "GBP", "priceWithTax": 2299, "taxRate": 0}}
        ]};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "breadcrumbs": {"0": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "items": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_log": ["Key does not exist in spec."]}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "product": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "3": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "4": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "5": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/magento-red-furniture-set.html with a cart item correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/magento-red-furniture-set.html", "referringURL": "http://ecom.example.com/furniture.html", "breadcrumbs": ["Furniture", "Magento Red Furniture Set"], "language": "en_GB", "pageName": "Magento Red Furniture Set"}, "category": {"primaryCategory": "Furniture", "pageType": "product"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "product": [
            {"productInfo": {"productID": "54", "productName": "Magento Red Furniture Set", "description": "Love red?  You'll love these pieces of handmade modern furniture!", "productURL": "http://ecom.example.com/catalog/product/view/id/54/s/magento-red-furniture-set/category/10/", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/m/a/magento-red-furniture-set.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/m/a/magento-red-furniture-set.jpg", "size": "500.0000"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 699.99, "currency": "GBP", "priceWithTax": 699.99, "taxRate": 0}}
        ], "cart": {"cartID": "225", "price": {"basePrice": 1799.99, "voucherDiscount": 0, "currency": "GBP", "taxRate": 0, "priceWithTax": 1799.99, "cartTotal": 1799.99}, "items": [
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/catalog/product/view/id/26/s/acer-ferrari-3200-notebook-computer-pc/category/10/", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "size": "11.4000"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0, "voucherDiscount": 0, "cartTotal": 1799.99}, "quantity": 1}
        ]}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "breadcrumbs": {"0": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "product": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "items": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_log": ["Key does not exist in spec."]}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/checkout/cart/ with 4 cart items correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/checkout/cart/", "referringURL": "http://ecom.example.com/magento-red-furniture-set.html", "language": "en_GB", "pageName": "Shopping Cart"}, "category": {"pageType": "basket"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "cart": {"cartID": "225", "price": {"basePrice": 3299.96, "currency": "GBP", "taxRate": 0, "priceWithTax": 3299.96, "cartTotal": 3299.96}, "items": [
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/acer-ferrari-3200-notebook-computer-pc.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "size": "11.4000"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0, "cartTotal": 1799.99}, "quantity": 1},
            {"productInfo": {"productID": "53", "productName": "Couch", "description": "For a sleek, simple and stylish piece, look no further than the Magento sofa - or sofabed!", "productURL": "http://ecom.example.com/couch.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/c/o/couch.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/c/o/couch.jpg", "size": "200.0000"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 599.99, "currency": "GBP", "priceWithTax": 599.99, "taxRate": 0, "cartTotal": 1199.98}, "quantity": 2},
            {"productInfo": {"productID": "51", "productName": "Ottoman", "description": "With durable solid wood framing, generous padding and plush stain-resistant microfiber upholstery.", "productURL": "http://ecom.example.com/ottoman.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/o/t/ottoman.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/o/t/ottoman.jpg", "size": "20.0000"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 299.99, "currency": "GBP", "priceWithTax": 299.99, "taxRate": 0, "cartTotal": 299.99}, "quantity": 1}
        ]}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "items": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com homepage with 4 cart items correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/", "referringURL": "http://ecom.example.com/checkout/cart/", "language": "en_GB", "pageName": "Home page"}, "category": {"pageType": "home"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "cart": {"cartID": "225", "price": {"basePrice": 3299.96, "voucherDiscount": 0, "currency": "GBP", "taxRate": 0, "priceWithTax": 3299.96, "cartTotal": 3299.96}, "items": [
            {"productInfo": {"productID": "26", "productName": "Acer Ferrari 3200 Notebook Computer PC", "description": "This exclusive edition is another striking symbol of cooperation between Acer and Ferrari -- two progressive companies with proud heritages built on passion, innovation, power and success", "productURL": "http://ecom.example.com/acer-ferrari-3200-notebook-computer-pc.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9d…eab33525d08d6e5fb8d27136e95/a/c/acer-ferrari-3200-notebook-computer-pc.jpg", "size": "11.4000"}, "category": {"primaryCategory": "Computers", "subCategory1": "Laptops"}, "price": {"basePrice": 1799.99, "currency": "GBP", "priceWithTax": 1799.99, "taxRate": 0, "voucherDiscount": 0, "cartTotal": 1799.99}, "quantity": 1},
            {"productInfo": {"productID": "53", "productName": "Couch", "description": "For a sleek, simple and stylish piece, look no further than the Magento sofa - or sofabed!", "productURL": "http://ecom.example.com/couch.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/c/o/couch.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/c/o/couch.jpg", "size": "200.0000"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 599.99, "currency": "GBP", "priceWithTax": 599.99, "taxRate": 0, "voucherDiscount": 0, "cartTotal": 1199.98}, "quantity": 2},
            {"productInfo": {"productID": "51", "productName": "Ottoman", "description": "With durable solid wood framing, generous padding and plush stain-resistant microfiber upholstery.", "productURL": "http://ecom.example.com/ottoman.html", "productImage": "http://ecom.example.com/media/catalog/product/cache/1/image/265x/9df78eab33525d08d6e5fb8d27136e95/o/t/ottoman.jpg", "productThumbnail": "http://ecom.example.com/media/catalog/product/cache/1/thumbnail/75x75/9df78eab33525d08d6e5fb8d27136e95/o/t/ottoman.jpg", "size": "20.0000"}, "category": {"primaryCategory": "Living Room"}, "price": {"basePrice": 299.99, "currency": "GBP", "priceWithTax": 299.99, "taxRate": 0, "voucherDiscount": 0, "cartTotal": 299.99}, "quantity": 1}
        ]}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "cartTotal": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "items": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "subCategory1": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_log": ["Key does not exist in spec."]}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "1": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_log": ["Key does not exist in spec."]}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "2": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "productID": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "description": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productImage": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "productThumbnail": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "size": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "primaryCategory": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "price": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "basePrice": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "currency": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "priceWithTax": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "taxRate": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}, "voucherDiscount": {"_log": ["Key does not exist in spec."]}, "cartTotal": {"_log": ["Key does not exist in spec."]}}, "quantity": {"_typeExpected": "number", "_typeFound": "number", "_typeCheck": "passed"}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

    test('should validate ecom.example.com/checkout/cart/ with no cart items correctly', function (done) {

        var digitalData, result, expected;
        digitalData = {"version": "1.0", "page": {"pageInfo": {"destinationURL": "http://ecom.example.com/checkout/cart/", "referringURL": "http://ecom.example.com/checkout/cart/", "language": "en_GB", "pageName": "Shopping Cart"}, "category": {"pageType": "basket"}}, "user": {"profile": [
            {"profileInfo": {"language": "en_GB", "returningStatus": "false"}}
        ]}, "cart": {"cartID": "225"}};
        expected = {"hasEmptyObjects": false, "emptyObjects": {}, "types": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "version": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "page": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "destinationURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "referringURL": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "pageName": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}, "category": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "pageType": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "user": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profile": {"0": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "profileInfo": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "language": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}, "returningStatus": {"_typeExpected": "string", "_typeFound": "string", "_typeCheck": "passed"}}}, "_typeExpected": "array", "_typeFound": "array", "_typeCheck": "passed"}}, "cart": {"_typeExpected": "object", "_typeFound": "object", "_typeCheck": "passed", "cartID": {"_log": ["Key does not exist in spec."]}}}, "missingObjects": {}, "isProductsMissingInCategoryPage": false, "isProductsMissingInCart": false};

        result = validator.run(digitalData);
        should.exist(result);
        result.should.eql(expected);

        done();
    });

});
